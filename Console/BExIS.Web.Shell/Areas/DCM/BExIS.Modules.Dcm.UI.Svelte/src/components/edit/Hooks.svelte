<script>
import HookContainer from '../HookContainer.svelte';
import Hook from '../Hook.svelte';
import Attachments from '../../pages/hooks/Attachment.svelte'

import { Spinner} from 'sveltestrap';
import {onMount} from 'svelte'


 export let id;
 export let version;
 export let hooks=[];

 $:seperateHooks(hooks);

let attachmentHook;

$:addtionalhooks= [];

// onMount(async () => {
//   seperateHooks(hooks);
// })

function seperateHooks(hooks)
{
  hooks.forEach(element => {
    
     if(element.name == "attachments"){ attachmentHook = element;} 
     else
     {
      // console.log(element.name)
      addtionalhooks.push(element);
     }
    });
}
 
</script>
 {#if addtionalhooks} <!-- if hooks list is loaded render hooks -->

 <HookContainer displayName = {attachmentHook.displayName} let:errorHandler let:successHandler>
  <div slot="view">
    <Attachments {id} {version} hook = {attachmentHook}  on:error={(e)=> errorHandler(e)} on:success={(e)=> successHandler(e)} />
  </div>
</HookContainer>

 {#each addtionalhooks as hook}
  <HookContainer displayName = {hook.displayName}>
    <div slot="view">
      <Hook {id} {version} {...hook} />
    </div>
  </HookContainer>
 {/each}
 
 {:else} <!-- while data is not loaded show a loading information -->
    <Spinner color="primary" size="sm" type ="grow" text-center />
 {/if}



